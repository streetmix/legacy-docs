

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installing Streetmix &mdash; Streetmix  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/sphinx_prompt_css.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Project organization" href="../project/" />
    <link rel="prev" title="Technical manual" href="../" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../" class="icon icon-home"> Streetmix
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../contributing/">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Technical manual</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Installing Streetmix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#on-mac-os-x">On Mac OS X</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-and-run-streetmix">Install and run Streetmix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#on-windows">On Windows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Install and run Streetmix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#on-linux">On Linux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#postgresql-configuration">PostgreSQL configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Install and run Streetmix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#instructions-for-all-systems">Instructions for all systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#clone-and-install-streetmix">Clone and install Streetmix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-environment-variables">Setting environment variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#starting-the-application">Starting the application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stopping-the-application">Stopping the application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-the-application">Updating the application</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#setup-in-an-offline-environment">Setup in an offline environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../project/">Project organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../csp/">Content Security Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tests/">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segment-definitions/">Segment definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environs/">Environs definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/">Helpers and utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../support/">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guidebook/">Guidebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact/">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Streetmix</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../">Docs</a> &raquo;</li>
        
          <li><a href="../">Technical manual</a> &raquo;</li>
        
      <li>Installing Streetmix</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/technical/installing-streetmix.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last"><strong>(August 2021) Streetmix documentation has now moved!</strong> Please update your bookmarks to <a class="reference external" href="https://docs.streetmix.net/">https://docs.streetmix.net/</a>.</p>
</div>
<div class="section" id="installing-streetmix">
<span id="install-streetmix"></span><h1>Installing Streetmix<a class="headerlink" href="#installing-streetmix" title="Permalink to this headline">¶</a></h1>
<p>These instructions are for first-time setup on a “local” or “development” environment.</p>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#on-mac-os-x" id="id7">On Mac OS X</a></li>
<li><a class="reference internal" href="#on-windows" id="id8">On Windows</a></li>
<li><a class="reference internal" href="#on-linux" id="id9">On Linux</a></li>
<li><a class="reference internal" href="#instructions-for-all-systems" id="id10">Instructions for all systems</a></li>
<li><a class="reference internal" href="#setup-in-an-offline-environment" id="id11">Setup in an offline environment</a></li>
<li><a class="reference internal" href="#troubleshooting" id="id12">Troubleshooting</a></li>
</ul>
</div>
<div class="section" id="on-mac-os-x">
<span id="install-macosx"></span><h2><a class="toc-backref" href="#id7">On Mac OS X</a><a class="headerlink" href="#on-mac-os-x" title="Permalink to this headline">¶</a></h2>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>You may already have some of these prerequisites installed. Skip or update the packages that already exist.</p>
<ol class="arabic">
<li><p class="first">Install <a class="reference external" href="https://itunes.apple.com/us/app/xcode/id497799835?mt=12">XCode Developer Tools</a>.</p>
</li>
<li><p class="first">Optionally, install the <a class="reference external" href="http://brew.sh/">Homebrew</a> package manager. This makes installing other software packages easier, but you can use any other package installation method you wish. In this example and in the following steps, we will use Homebrew on the command line to set up your development environment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">/usr/bin/ruby -e <span class="s2">&quot;</span><span class="k">$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="k">)</span><span class="s2">&quot;</span></span>
</pre></div></div></li>
<li><p class="first">Install <a class="reference external" href="https://nodejs.org/en/">Node.js</a>. In production, Streetmix uses the latest “Active LTS” release. Locally, you should be able to use any version of Node.js in the “Current” or “Active” state. While you can download installers and binaries from the website, Homebrew makes it easier to keep Node.js up to date in the future. Let’s install Node.js with Homebrew:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">brew install nodejs</span>
</pre></div></div></li>
<li><p class="first">Install PostgreSQL. You can <a class="reference external" href="https://www.postgresql.org/download/macosx/">download MacOSX packages here</a> or use the <a class="reference external" href="https://postgresapp.com/">Postgres app</a>, but the easiest method would be to use Homebrew, again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">brew install postgres</span>
</pre></div></div></li>
<li><p class="first">Install PostGIS. You can <a class="reference external" href="https://postgis.net/install/">download MacOSX packages here</a> but just like above the easiest method would be to use Homebrew:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">brew install postgis</span>
</pre></div></div></li>
</ol>
</div>
<div class="section" id="install-and-run-streetmix">
<h3>Install and run Streetmix<a class="headerlink" href="#install-and-run-streetmix" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="#install-all"><span class="std std-ref">Instructions for all systems</span></a>, below.</p>
</div>
</div>
<div class="section" id="on-windows">
<span id="install-windows"></span><h2><a class="toc-backref" href="#id8">On Windows</a><a class="headerlink" href="#on-windows" title="Permalink to this headline">¶</a></h2>
<p>These instructions below will assume that the user has basic familiarity with Git, GitHub, and the Git Bash or Windows Powershell command line interface, and has administrative permissions to install software on the machine.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Streetmix was not developed on a Windows platform, and testing is limited. Although our users have successfully stood up Streetmix on Windows machines in the past, these instructions may be out of date.</p>
</div>
<div class="section" id="id2">
<h3>Prerequisites<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>You may already have some of these prerequisites installed. Skip or update the packages that already exist.</p>
<ol class="arabic simple">
<li>Install <a class="reference external" href="http://browsehappy.com/">a modern browser</a>. We recommend Firefox or Chrome. Internet Explorer is not supported. (See <a class="reference internal" href="../../support/faq/#faq-internet-explorer"><span class="std std-ref">Does Streetmix support Internet Explorer?</span></a>).</li>
<li>Install <a class="reference external" href="http://git-scm.com/download/win">Git</a>. You may want to consider following Microsoft’s guide to <a class="reference external" href="https://docs.microsoft.com/en-us/windows/wsl/tutorials/wsl-git">Windows Subsystem for Linux</a>, which helps us provide similar command line instructions to Mac OSX and Linux environments.</li>
<li>Install <a class="reference external" href="https://nodejs.org/en/">Node.js</a>. The site should detect your Windows system and provide you with the correct install executable, but you may download a specific package at <a class="reference external" href="http://nodejs.org/download/">http://nodejs.org/download/</a> (e.g. Windows 64-bit installer). In production, Streetmix uses the latest “Active LTS” release. Locally, you should be able to use any version of Node.js in the “Current” or “Active” state.</li>
<li>Install PostgreSQL. You can <a class="reference external" href="https://www.postgresql.org/download/windows/">download Windows packages here</a>.</li>
<li>Install PostGIS. You can <a class="reference external" href="https://postgis.net/windows_downloads/">download Windows packages here</a>.</li>
</ol>
</div>
<div class="section" id="id4">
<h3>Install and run Streetmix<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="#install-all"><span class="std std-ref">Instructions for all systems</span></a>, below.</p>
</div>
</div>
<div class="section" id="on-linux">
<span id="install-linux"></span><h2><a class="toc-backref" href="#id9">On Linux</a><a class="headerlink" href="#on-linux" title="Permalink to this headline">¶</a></h2>
<p>The Linux ecosystem can vary greatly depending on distribution (or “distro”) and developer preferences, which makes it challenging to maintain accurate and up-to-date installation instructions that will be perfect for every instance. Consequently, our instructions must assume that the user has basic familiarity with their own system, that common developer tools such as <code class="code docutils literal notranslate"><span class="pre">git</span></code> are already installed or that the user knows how to obtain them on their own, and that the user has the necessary permissions to install software on the machine.</p>
<p>Here, our goal is to provide quick-start instructions that should work in most cases, with minimal configuration. However, experienced developers should feel free to modify any of the instructions as necessary according to their own preferences (e.g. database usernames, etc.).</p>
<div class="section" id="id5">
<h3>Prerequisites<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>The primary requirements for this project are Node.js, PostgreSQL and PostGIS. You will need those installed if you do not have them already.</p>
<ol class="arabic simple">
<li>Install <a class="reference external" href="https://nodejs.org/en/">Node.js</a>. There are different methods for installing Node.js, and you will need to choose a method depending on your own preference. In production, Streetmix uses the latest “Active LTS” release. Locally, you should be able to use any version of Node.js in the “Current” or “Active” state.<ul>
<li><strong>Method 1: install with nvm (recommended).</strong> <code class="code docutils literal notranslate"><span class="pre">nvm</span></code> is a command-line tool to manage multiple Node.js versions on a machine. This is effective for development and troubleshooting with multiple Node.js versions, and also makes it easy to install and upgrade Node.js versions over time. <a class="reference external" href="https://github.com/nvm-sh/nvm">Learn how to install and use nvm from the repository: https://github.com/nvm-sh/nvm</a>.</li>
<li><strong>Method 2: package manager installation.</strong> Many Linux distributions have package managers from where you can install Node.js. The Node.js documentation provides <a class="reference external" href="https://nodejs.org/en/download/package-manager/">a list of package managers and installation instructions</a>, but please note the disclaimer that package manager versions are maintained by the Linux community, not by the Node.js team. As a result, not all package managers have the latest Node.js versions at all times.</li>
<li><strong>Method 3: source download.</strong> <a class="reference external" href="https://nodejs.org/">Download the latest source tarball from the Node.js homepage</a> or <a class="reference external" href="https://nodejs.org/download/">choose a specific package from the Node.js download page</a>. Instructions for installing from source are sparse and is only recommended for expert Node.js users.</li>
</ul>
</li>
<li>Install PostgreSQL. From the <a class="reference external" href="https://www.postgresql.org/download/">PostgreSQL download page</a> select Linux, then your Linux distribution, for installation instructions.</li>
<li>Install PostGIS. <a class="reference external" href="https://postgis.net/install/">Linux instructions (per distribution) are available here</a>.</li>
<li>Configure PostgreSQL. If this is your first time installing PostgreSQL, you may need to set up some initial configuration, in the next section.</li>
</ol>
</div>
<div class="section" id="postgresql-configuration">
<h3>PostgreSQL configuration<a class="headerlink" href="#postgresql-configuration" title="Permalink to this headline">¶</a></h3>
<div class="section" id="archlinux">
<h4>ArchLinux<a class="headerlink" href="#archlinux" title="Permalink to this headline">¶</a></h4>
<p>Here is <a class="reference external" href="https://wiki.archlinux.org/index.php/PostgreSQL">additional setup instructions for ArchLinux</a>.</p>
</div>
<div class="section" id="debian-ubuntu">
<h4>Debian/Ubuntu<a class="headerlink" href="#debian-ubuntu" title="Permalink to this headline">¶</a></h4>
<p>In our experience, the Debian or Ubuntu package restricts the authentication methods such that one must set up a username with a password in order for Streetmix to be able to access the database. If you experience login problems, check the pg_hba.conf file (<a class="reference external" href="https://www.postgresql.org/docs/12/auth-pg-hba-conf.html">see documentation</a>) to see if the <code class="docutils literal notranslate"><span class="pre">trust</span></code> authentication method isn’t present for the user. You can either modify that configuration file, or follow these basic instructions for setting up a new user.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1"><span class="c1"># Switch to the PostgreSQL administrator user</span></span>
<span class="prompt1">sudo -iu postgres</span>
<span class="prompt1"></span>
<span class="prompt1"><span class="c1"># Create a new username</span></span>
<span class="prompt1"><span class="c1"># Tip: if you create a user with the same name as your Linux</span></span>
<span class="prompt1"><span class="c1"># username, you won&#39;t need to set the username in Streetmix</span></span>
<span class="prompt1">createuser streetmix_user</span>
<span class="prompt1"></span>
<span class="prompt1"><span class="c1"># Enter the PostgreSQL console</span></span>
<span class="prompt1">psql</span>
<span class="prompt1"></span>
<span class="prompt1"><span class="c1"># Give your user permission to create and migrate the database</span></span>
<span class="prompt1">ALTER USER streetmix_user WITH CREATEDB SUPERUSER<span class="p">;</span></span>
<span class="prompt1"></span>
<span class="prompt1"><span class="c1"># Set a user password</span></span>
<span class="prompt1">ALTER USER streetmix_user WITH PASSWORD <span class="s1">&#39;password&#39;</span><span class="p">;</span></span>
<span class="prompt1"></span>
<span class="prompt1"><span class="c1"># Leave the database</span></span>
<span class="prompt1"><span class="c1"># Note: if prompted, type \q</span></span>
<span class="prompt1"><span class="nb">exit</span></span>
<span class="prompt1"></span>
<span class="prompt1"><span class="c1"># Switch back to original user</span></span>
<span class="prompt1"><span class="nb">exit</span></span>
</pre></div></div></div></blockquote>
<p>The user created here only needs the <code class="docutils literal notranslate"><span class="pre">SUPERUSER</span></code> role during migration. After a successful initial migration, you may remove the <code class="docutils literal notranslate"><span class="pre">SUPERUSER</span></code> role.</p>
</div>
<div class="section" id="other">
<h4>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h4>
<p>You may need to look for instructions more specific to your distro for setting up PostgreSQL.</p>
<p>We also welcome contributions to our documentation, so if you get Streetmix up and running on a different distro and would like to share how, please feel free!</p>
</div>
</div>
<div class="section" id="id6">
<h3>Install and run Streetmix<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="#install-all"><span class="std std-ref">Instructions for all systems</span></a>, below.</p>
</div>
</div>
<div class="section" id="instructions-for-all-systems">
<span id="install-all"></span><h2><a class="toc-backref" href="#id10">Instructions for all systems</a><a class="headerlink" href="#instructions-for-all-systems" title="Permalink to this headline">¶</a></h2>
<p>After installing all prerequisites (depending on your platform, see above), you can now install and run Streetmix. Assuming all the prerequisites are installed correctly, the instructions below should work on most platforms in the command line terminal. (Note: for Windows platforms, we recommend using Git Bash or Windows Powershell to use these commands.)</p>
<div class="section" id="clone-and-install-streetmix">
<h3>Clone and install Streetmix<a class="headerlink" href="#clone-and-install-streetmix" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">In the command line terminal, clone the Streetmix repository to a folder on your computer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">git clone https://github.com/streetmix/streetmix.git</span>
</pre></div></div></li>
<li><p class="first">Change the directory to Streetmix’s root directory, and install project dependencies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1"><span class="nb">cd</span> streetmix</span>
<span class="prompt1">npm install</span>
</pre></div></div><div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">We are not using the <strong>Yarn</strong> package manager. Installing with Yarn may cause unpredictable errors.</p>
</div>
</li>
<li><p class="first">(Optional) If necessary, create a <code class="file docutils literal notranslate"><span class="pre">.env</span></code> file and set PosgreSQL credentials. <strong>Note: By default, most environments will not require PostgreSQL credentials.</strong> For more information, including instructions for setting third-party tokens to run services like authentication or localization, see <a class="reference internal" href="#install-env-vars"><span class="std std-ref">Setting environment variables</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1"><span class="c1"># Make a copy of the environment variables file</span></span>
<span class="prompt1">cp .env.example .env</span>
<span class="prompt1"></span>
<span class="prompt1"><span class="c1"># Using vim, but replace with your editor</span></span>
<span class="prompt1">vim .env</span>
</pre></div></div><p>You may use any editor you wish in place of vim. Set your username and password, as well as other database credentials, as necessary, by uncommenting the appropriate lines and setting the environment variables. The following is an example:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PGUSER</span><span class="o">=</span><span class="n">streetmix_user</span>
<span class="n">PGPASSWORD</span><span class="o">=</span><span class="n">streetmix</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If the PostgreSQL username is the same as your operating system’s current username, <code class="docutils literal notranslate"><span class="pre">PGUSER</span></code> is assumed to be that username by default, and you won’t need to set it explicitly.</p>
</div>
</li>
<li><p class="first">Initialize the PostgreSQL database.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">npx sequelize db:create</span>
<span class="prompt1">npx sequelize db:migrate</span>
<span class="prompt1"><span class="nv">NODE_ENV</span><span class="o">=</span><span class="nb">test</span> npx sequelize db:create</span>
<span class="prompt1"><span class="nv">NODE_ENV</span><span class="o">=</span><span class="nb">test</span> npx sequelize db:migrate</span>
</pre></div></div><div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>If you run into issues creating or migrating the database, you can access Sequelize’s “verbose” debug output with the command <code class="docutils literal notranslate"><span class="pre">DEBUG=sequelize*</span> <span class="pre">npx</span> <span class="pre">sequelize</span> <span class="pre">db:migrate</span></code>. (This feature is not well-documented by Sequelize.)</p>
<p class="last">Debug a migration on a Heroku application instance like so: <code class="docutils literal notranslate"><span class="pre">heroku</span> <span class="pre">run</span> <span class="pre">'DEBUG=sequelize*</span> <span class="pre">npx</span> <span class="pre">sequelize</span> <span class="pre">db:migrate'</span> <span class="pre">--app</span> <span class="pre">&lt;heroku</span> <span class="pre">app</span> <span class="pre">id&gt;</span></code> (Note the quotation marks surrounding the command.)</p>
</div>
<p>In general, Sequelize will print a confirmation or an error after completing each command. If creating the database is successful, you should be able to see the database using psql, PgAdmin, or other tools. A modern, open source, and cross-platform database GUI tool is <a class="reference external" href="https://www.beekeeperstudio.io/">Beekeeper Studio</a>. The database needs to successfully exist before migrations can occur.</p>
<p>Notice that the database create and migrate commands are run a second time prepended with <code class="docutils literal notranslate"><span class="pre">NODE_ENV=test</span></code>. This is because your local environment and a test environment use different database instances, and both of them need to be set up.</p>
<p>You cannot run Streetmix without successfully creating a database, so this is an important step!</p>
</li>
</ol>
</div>
<div class="section" id="setting-environment-variables">
<span id="install-env-vars"></span><h3>Setting environment variables<a class="headerlink" href="#setting-environment-variables" title="Permalink to this headline">¶</a></h3>
<p>Environment variables store secret values (like authentication keys and passwords) used to connect to third-party services. Just like regular passwords, secrets should never be revealed to the public, so we store them in a <code class="file docutils literal notranslate"><span class="pre">.env</span></code> file that isn’t committed to the repository.</p>
<p>You can create a <code class="file docutils literal notranslate"><span class="pre">.env</span></code> by copying the starter <code class="file docutils literal notranslate"><span class="pre">.env.example</span></code> in the Streetmix root directory.</p>
<p>To obtain keys for local development, you should be able to create your own free-tier accounts at each service and refer to their documentation for more information. To obtain keys to production resources, you will need to ask the project maintainers.</p>
<div class="section" id="required-environment-variables">
<h4>Required environment variables<a class="headerlink" href="#required-environment-variables" title="Permalink to this headline">¶</a></h4>
<p>The only required environment variables are the keys used for the Auth0 authentication service. Streetmix will run without this, but a lot of functionality is only available to signed-in users, and you will need these keys to sign in.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="50%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable name</th>
<th class="head">Description</th>
<th class="head">Required</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">AUTH0_DOMAIN</span></code></td>
<td>Authentication service (Auth0) domain</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">AUTH0_CLIENT_ID</span></code></td>
<td>Authentication service (Auth0) client ID</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">AUTH0_CLIENT_SECRET</span></code></td>
<td>Authentication service (Auth0) client secret</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="optional-environment-variables">
<h4>Optional environment variables<a class="headerlink" href="#optional-environment-variables" title="Permalink to this headline">¶</a></h4>
<p>Streetmix will run without these keys. Some functionality will be limited, but they are not critical.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="50%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable name</th>
<th class="head">Description</th>
<th class="head">Required</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">PELIAS_API_KEY</span></code></td>
<td>Geocoding (Pelias) API key</td>
<td>No</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">TRANSIFEX_API_TOKEN</span></code></td>
<td>Translations (Transifex) API token</td>
<td>No</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CLOUDINARY_API_KEY</span></code></td>
<td>Image cloud storage (Cloudinary) key</td>
<td>No</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CLOUDINARY_API_SECRET</span></code></td>
<td>Image cloud storage (Cloudinary) secret</td>
<td>No</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="optional-database-configuration-postgresql">
<h4>Optional database configuration (PostgreSQL)<a class="headerlink" href="#optional-database-configuration-postgresql" title="Permalink to this headline">¶</a></h4>
<p>Environment variables are the preferred way for PostgreSQL to access the database. If you have a local database that are not using default values, you can set these here as well. Usually, you won’t need to specify these at all.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="33%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable name</th>
<th class="head">Description</th>
<th class="head">Default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">PGUSER</span></code></td>
<td>PostgreSQL username</td>
<td>(your system username)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">PGPASSWORD</span></code></td>
<td>PostgreSQL password</td>
<td>(none)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">PGDATABASE</span></code></td>
<td>PostgreSQL database name</td>
<td><code class="docutils literal notranslate"><span class="pre">streetmix_dev</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">PGHOST</span></code></td>
<td>PostgreSQL server host IP</td>
<td><code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">PGPORT</span></code></td>
<td>PostgreSQL server post</td>
<td><code class="docutils literal notranslate"><span class="pre">5432</span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sample-env">
<h4>Sample .env<a class="headerlink" href="#sample-env" title="Permalink to this headline">¶</a></h4>
<p>A sample <code class="file docutils literal notranslate"><span class="pre">.env</span></code> file looks like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AUTH0_CLIENT_ID</span><span class="o">=</span><span class="mi">1234567890</span>
<span class="n">AUTH0_CLIENT_SECRET</span><span class="o">=</span><span class="n">abcdefghij</span>
<span class="n">PELIAS_API_KEY</span><span class="o">=</span><span class="n">a2c4e6g8i</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="starting-the-application">
<h3>Starting the application<a class="headerlink" href="#starting-the-application" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Start the PostgreSQL service. (Note: the method for doing this may differ depending on your operating system and how you installed PostgreSQL.)</p>
</li>
<li><p class="first">Start the web server. In the Streetmix project directory, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">npm start</span>
</pre></div></div></li>
<li><p class="first">Load the application in your web browser by navigating to <code class="docutils literal notranslate"><span class="pre">http://localhost:8000</span></code> or by running in your terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">open http://localhost:8000</span>
</pre></div></div></li>
</ol>
</div>
<div class="section" id="stopping-the-application">
<h3>Stopping the application<a class="headerlink" href="#stopping-the-application" title="Permalink to this headline">¶</a></h3>
<p>To stop running Streetmix, press <kbd class="kbd docutils literal notranslate">Ctrl-C</kbd>.</p>
</div>
<div class="section" id="updating-the-application">
<h3>Updating the application<a class="headerlink" href="#updating-the-application" title="Permalink to this headline">¶</a></h3>
<p>Every so often, you will need to update the project.</p>
<ol class="arabic">
<li><p class="first">Pull the latest code from the repository.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">git pull</span>
</pre></div></div></li>
<li><p class="first">Install the latest version of all dependencies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">npm install</span>
</pre></div></div></li>
<li><p class="first">Update the database schema.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">npx sequelize db:migrate</span>
</pre></div></div></li>
</ol>
</div>
</div>
<div class="section" id="setup-in-an-offline-environment">
<h2><a class="toc-backref" href="#id11">Setup in an offline environment</a><a class="headerlink" href="#setup-in-an-offline-environment" title="Permalink to this headline">¶</a></h2>
<p>This is for a special case where you may need to deploy Streetmix onto machines that are going to be running in an environment without Internet access, such as a public space without Wi-Fi, or a conference center with very limited Wi-Fi. To put Streetmix into “offline mode”, set your <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NODE_ENV</span></code> environment variable to <code class="docutils literal notranslate"><span class="pre">demo</span></code>.</p>
<p>You may do this by editing the <code class="file docutils literal notranslate"><span class="pre">.env</span></code> file (see <a class="reference internal" href="#install-env-vars"><span class="std std-ref">Setting environment variables</span></a> for more information about this file).</p>
<p>You can also do it one time by starting the server like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1"><span class="nv">NODE_ENV</span><span class="o">=</span>demo npm start</span>
</pre></div></div><div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">“Offline mode” is not a well-supported feature of Streetmix. Use it with care.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">When you are running Streetmix on a device without Internet access, you do not need to provide environment variables for to authenticate third-party services such as Auth0.</p>
</div>
</div>
<div class="section" id="troubleshooting">
<h2><a class="toc-backref" href="#id12">Troubleshooting</a><a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>If you run into problems, please see the <a class="reference internal" href="../../support/troubleshooting/#troubleshooting-development-issues"><span class="std std-ref">Development issues</span></a> section.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../project/" class="btn btn-neutral float-right" title="Project organization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../" class="btn btn-neutral float-left" title="Technical manual" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Streetmix LLC

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>